# Skeleton Code Guide ‚Äî What's Ready to Implement

**Last Updated**: February 16, 2026  
**Status**: Placeholder files created with TODO comments

---

## What I've Created for You

I've created skeleton files for all the critical missing pieces. **They compile but throw "Not yet implemented" errors** ‚Äî this is intentional to guide you through what to fill in.

Each file has TODO comments showing exactly where to add code.

---

## File Inventory

### Frontend Hooks (Placeholder Stubs)

| File | Purpose | Status |
|------|---------|--------|
| `lib/hooks/useWallet.ts` | Wallet connection state | ‚è≥ Stub: returns interface, throws on use |
| `lib/hooks/useProgram.ts` | Anchor client wrapper | ‚è≥ Stub: returns program instance (null), instruction builders throw |
| `lib/hooks/useXPBalance.ts` | Fetch XP token balance | ‚è≥ Stub: returns balance = 0 |

**What to do**:
1. Read comments in each file (shows exactly what to implement)
2. After Anchor program is deployed + IDL generated, fill in the implementations
3. Each file has clear "TODO:" sections

---

### Frontend Services (Async API Clients)

| File | Purpose | Status |
|------|---------|--------|
| `lib/services/helius.service.ts` | Helius DAS API queries | ‚è≥ Stub: methods throw "Not implemented" |
| `lib/services/photon.service.ts` | Photon ZK queries | ‚è≥ Stub: methods throw "Not implemented" |

**What to do**:
1. Sign up for Helius API key: https://www.helius.dev/
2. Get `NEXT_PUBLIC_HELIUS_API_KEY` env var
3. Implement HTTP requests (code templates in comments)
4. Test with `curl` before wiring to UI

---

### Frontend Configuration

| File | Purpose | Status |
|------|---------|--------|
| `lib/wallet-config.ts` | Wallet adapter setup | ‚úÖ Ready to use (no changes needed) |
| `components/auth/WalletConnect.tsx` | Connect wallet button | ‚úÖ Uses `@solana/wallet-adapter-react-ui` (ready) |
| `components/providers/WalletProvider.tsx` | Already exists | ‚úÖ Already configured with 12 wallets |

**What to do**: Nothing ‚Äî these are ready to use!

---

### Backend Services (Transaction Builder)

| File | Purpose | Status |
|------|---------|--------|
| `backend/src/services/transaction.service.ts` | TX builder + signer | ‚è≥ Stub: methods throw "Not implemented" |
| `backend/src/routes/transaction.ts` | API endpoint | ‚è≥ Stub: calls transaction.service |
| `backend/src/config.ts` | Solana env settings | ‚úÖ Config + validation ready |

**What to do**:
1. Deploy Anchor program to Devnet
2. Get IDL from `target/idl/academy.json` (auto-generated by Anchor)
3. Copy IDL to `lib/anchor/academy.json`
4. Implement instruction builders in `transaction.service.ts`
5. Wire up to Express routes in `backend/src/index.ts`

---

## Implementation Order

### Step 1: Environment Setup (Today)
```bash
# .env.local (frontend)
NEXT_PUBLIC_SOLANA_NETWORK=devnet
NEXT_PUBLIC_SOLANA_RPC=https://api.devnet.solana.com
NEXT_PUBLIC_HELIUS_API_KEY=your_key_here
NEXT_PUBLIC_PHOTON_API_URL=https://api.helius.xyz/photon
NEXT_PUBLIC_ANCHOR_PROGRAM_ID=4K3Dyjzvzp8eMZWUXbCgcaQKKV2TTLv4JXwwVnDq9zJF  # Update when deployed

# backend/.env
SOLANA_RPC_URL=https://api.devnet.solana.com
ANCHOR_PROGRAM_ID=4K3Dyjzvzp8eMZWUXbCgcaQKKV2TTLv4JXwwVnDq9zJF
BACKEND_SIGNER_SECRET_KEY=[1,2,3,...]  # Your keypair as JSON
XP_TOKEN_MINT=EPjFWaLb3odcccccccccccccccccccccccccccccccccc  # Update when created
NETWORK=devnet
```

### Step 2: Create Anchor Program (Weeks 1-3)
```bash
# In a separate repo or programs/ folder:
# Design + implement all 16 instructions
# Test locally with anchor test
# Deploy to Devnet

# Generate IDL: target/idl/academy.json
# Copy to: lib/anchor/academy.json
```

### Step 3: Fill in Backend Transaction Service (Days 1-5)
Read: `backend/src/services/transaction.service.ts`

For each method (buildEnrollInstruction, buildCompleteLessonInstruction, etc.):
```typescript
// 1. Derive PDAs:
const course = PublicKey.findProgramAddressSync(['course', Buffer.from(courseId)], PROGRAM_ID)[0]
const enrollment = PublicKey.findProgramAddressSync(
  ['enrollment', Buffer.from(courseId), new PublicKey(userId).toBuffer()],
  PROGRAM_ID
)[0]

// 2. Build instruction using Anchor:
return this.program.methods
  .completeLessonCPI(lessonIndex, xpAmount)
  .accounts({
    course,
    enrollment,
    config,
    xpMint,
    userXpAta,
    user: new PublicKey(userId),
    tokenProgram: TOKEN_PROGRAM_ID,
    // ... other accounts
  })
  .instruction()

// 3. Sign with backend keypair (already done in signTransaction())
```

### Step 4: Fill in Frontend Hooks (Days 1-3)
Read: `lib/hooks/useProgram.ts`

```typescript
export function useProgram(programId?: PublicKey) {
  const provider = useAnchorProvider() // Create this or use existing
  const { publicKey } = useWallet()

  const program = useMemo(() => {
    if (!programId || !provider) return null
    return new Program(IDL, programId, provider)
  }, [programId, provider])

  return {
    program,
    instructions: {
      async enroll(courseId: string) {
        // Use program.methods to build instruction
      }
    }
  }
}
```

### Step 5: Fill in Indexing Services (Days 1-3)
Read: `lib/services/helius.service.ts` and `lib/services/photon.service.ts`

For Helius:
```typescript
async getTokenHolders(mint: PublicKey, limit = 100) {
  const response = await fetch(
    `https://api.helius.xyz/v0/token/holders?api_key=${this.apiKey}&mint=${mint.toBase58()}&limit=${limit}`
  )
  const data = await response.json()
  return data.result.map(h => ({ owner: new PublicKey(h.owner), balance: h.amount }))
}
```

### Step 6: Wire Up Leaderboard (1 day)
Update: `app/leaderboard/page.tsx`

```typescript
const { data: holders } = useQuery({
  queryKey: ['leaderboard'],
  queryFn: () => heliusService.getLeaderboard(xpTokenMint, 100),
  refetchInterval: 10000, // Refresh every 10s
})
```

---

## Testing Each Piece

### Test Anchor Program ‚úÖ LOCAL
```bash
cd programs/academy
anchor build
anchor test
# Should pass all instruction tests
```

### Test Backend TX Builder ‚úÖ CURL
```bash
# Start backend
cd backend && npm run dev

# Test TX endpoint
curl -X POST http://localhost:3001/api/transaction/complete-lesson \
  -H "Authorization: Bearer $JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"courseId":"math-101","lessonIndex":0,"xpAmount":100}'

# Should return: { signedTx: "...", blockhash: "..." }
```

### Test Frontend Wallet ‚úÖ BROWSER
```bash
npm run dev
# Open http://localhost:3000
# Header should have "Connect Wallet" button
# Click ‚Üí choose wallet ‚Üí shows connected address
```

### Test End-to-End ‚úÖ DEVNET
```
1. User navigates to /courses/[slug]/lessons/[id]
2. Clicks "Complete Lesson"
3. Frontend calls POST /api/transaction/complete-lesson
4. Gets signed TX from backend
5. User wallet (Phantom, etc.) signs
6. Frontend submits to Solana
7. TX confirmed on Devnet
8. XP appears in user's ATA
9. Leaderboard updates in real-time
```

---

## Important Notes

### ‚ö†Ô∏è What Will Fail Until You Implement

- ‚úÖ Frontend pages render (they're not blocked)
- ‚úÖ Wallet button shows (but clicking may error without wallet impl)
- ‚ùå `useProgram()` ‚Üí Throws "Not initialized" until you call `.enroll()`, etc.
- ‚ùå `heliusService.getTokenHolders()` ‚Üí Returns empty until Helius API is called
- ‚ùå TX builder ‚Üí Throws "Not implemented" until Anchor program is deployed
- ‚úÖ Backend API ‚Üí Compiles, just won't have TX endpoints until transaction.service is filled in

### üìù Following the TODO Comments

Each placeholder file has TODO comments. They're ordered by:
1. **What** needs to be implemented
2. **Why** it matters
3. **How** to do it (with code samples)

Example:
```typescript
// TODO: Implement Helius query
// Steps:
// 1. Call Helius getTokenHolders API
// 2. Parse response
// 3. Convert to our format
// const response = await fetch(...)
```

### üîÑ Dependency Chain

```
Program IDL (required first)
    ‚Üì
transaction.service.ts (uses IDL for instruction building)
    ‚Üì
backend routes (calls transaction service)
    ‚Üì
useProgram() hook (mirrors program.methods)
    ‚Üì
Frontend lesson page (calls useProgram to submit TX)
    ‚Üì
Helius + Photon services (query results)
    ‚Üì
Leaderboard + certificate pages (display real data)
```

---

## Next Steps

1. **Review skeleton files**: Open each TODO file and read the comments
2. **Start with Anchor**: The skeleton can't be filled in until the program exists
3. **Test locally**: Anchor on Devnet ‚Üí Backend TX builder ‚Üí Frontend integration
4. **Wire up one lesson**: `enroll` ‚Üí `complete_lesson` ‚Üí leaderboard update
5. **Iterate**: Add more features (credentials, achievements, etc.)

---

## Questions?

- **"How do I create Anchor IDL?"**: See [Anchor docs](https://coral-xyz.github.io/anchor/)
- **"How do I get Helius API key?"**: Sign up at [helius.dev](https://www.helius.dev/)
- **"How do I format BACKEND_SIGNER_SECRET_KEY?"**: Run `solana-keygen new`, then `cat keypair.json | jq -c '.'`
- **"What if I get 'Program not initialized'?"**: Check your `.env` variables are set
- **"How do I debug TX failures?"**: Use `solana tx show <signature>` on Devnet scanner

---

**Good luck! üöÄ**

Once you implement these pieces, your system will be production-ready for Solana integration.

